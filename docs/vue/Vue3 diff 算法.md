# Vue3 diff 算法

Vue 3 的 diff 算法相较于 Vue 2 进行了优化，特别是在减少 DOM 操作方面做得更为精细。以下是一些 Vue 3 diff 算法的关键特点和优化点：

1. **静态标记与非全量 Diff**:
   - Vue 3 在构建虚拟 DOM 时，会对不会变动的节点进行静态标记。在后续的 diff 过程中，这些标记的节点会被跳过，从而减少了不必要的比较，提高了效率。
2. **最长递增子序列 (Longest Increasing Subsequence, LIS)**:
   - 为了最小化 DOM 元素的移动，Vue 3 引入了 LIS 算法。这个算法帮助确定最优的节点移动路径，确保在重新排列列表项时进行最少的 DOM 操作。
3. **预处理前置与后置元素**:
   - 在 diff 开始之前，Vue 3 会预处理前置和后置元素，即首先尝试匹配并处理列表开头和结尾的相同节点，减少后续处理的复杂度。
4. **分块处理**:
   - Vue 3 的 diff 算法可能采用了分块处理的策略，将较大的节点列表分成小块进行比较，进一步优化了遍历和比较的过程。
5. **改进的键处理**:
   - 继续使用`key`来辅助节点的识别与复用，但处理逻辑得到了优化，使得在有大量列表变动时能更高效地定位到需要移动的节点。
6. **快速 diff 算法**:
   - 引入了快速 diff 算法，针对不同场景（如新增、删除、移动等）设计了专门的处理逻辑，简化了复杂情况下的 diff 过程。
7. **动态规划策略**:
   - 在某些情况下，Vue 3 利用动态规划来寻找最小操作序列，这是为了减少 DOM 操作的次数，提升性能。

Vue 3 的 diff 算法在设计上更加注重性能和效率，尤其是在处理大型列表和动态内容变更时，通过上述优化策略尽量减少 DOM 的重排和重绘，从而提升用户体验。这些改变反映了 Vue 团队在性能优化上的持续努力。
